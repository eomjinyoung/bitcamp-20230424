<!DOCTYPE html>
<html>
<head>
  <meta charset='UTF-8'>
  <title>비트캠프</title>
  <link rel="stylesheet" href="/css/common.css">
</head>
<body>

  <header class="x-page-header"></header>

<h1>회원</h1>
<form id="x-member-form" enctype='multipart/form-data'>
<table border='1'>
<tr>
  <th>이름</th> <td style='width:200px;'><input type='text' name='name'></td>
</tr>
<tr>
  <th>이메일</th> <td><input type='email' name='email'></td>
</tr>
<tr>
  <th>암호</th> <td><input type='password' name='password'></td>
</tr>
<tr>
  <th>성별</th>
  <td>
    <select name='gender'>
      <option value='M'>남자</option>
      <option value='W'>여자</option>
    </select>
  </td>
</tr>
<tr>
  <th>사진</th> <td><input type='file' name='photofile'></td>
</tr>
</table>
<button>등록</button>
</form>

<footer class="x-page-footer"></footer>

<script src="/node_modules/jquery/dist/jquery.min.js"></script>
<script src="/node_modules/jquery.cookie/jquery.cookie.js"></script>
<script src="/js/common.js"></script>
<script src="/js/page-init.js"></script>
<script>
    "use strict";

    const memberForm = $("#x-member-form");

    memberForm.submit((e) => {
        e.preventDefault();

        $.ajax(`${RESTAPI_HOST}/members`, {
            xhrFields: {
                withCredentials: true
            },
            headers: {
                "X-XSRF-TOKEN": $.cookie("XSRF-TOKEN")
            },
            method: "POST",
            dataType: "json",
            contentType: false,
            processData: false,
            data: new FormData(memberForm[0]),
        })
        .done((result) => {
            //console.log(result);
            if (result.status == "success") {
                location.href = "list.html";
            } else {
                alert("회원 등록 오류입니다!");
            }
        });
    });
</script> 

</body>
</html>
